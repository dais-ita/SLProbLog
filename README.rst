Code for https://arxiv.org/abs/1809.07888